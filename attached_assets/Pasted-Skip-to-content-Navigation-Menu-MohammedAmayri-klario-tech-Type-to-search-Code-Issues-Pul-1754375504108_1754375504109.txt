Skip to content
Navigation Menu
MohammedAmayri
klario-tech

Type / to search
Code
Issues
Pull requests
Actions
Projects
Wiki
Security
Insights
Settings
Deploy Klario to Production
Consolidate deployment files for transfer to streamline the deploymenâ€¦ #30
Jobs
Run details
build-and-deploy
failed 3 minutes ago in 1m 47s
Search logs
2s
3s
2s
0s
5s
17s
27s
0s
17s
17s
14s
/usr/bin/docker run --name ee1dcf3f0ccdd8eb43b69ce2f4bcb281d133_17db18 --label 00ee1d --workdir /github/workspace --rm -e "NODE_VERSION" -e "DOCKER_IMAGE_NAME" -e "DOCKER_TAG" -e "PROD_HOST" -e "PROD_USER" -e "PROD_PORT" -e "INPUT_HOST" -e "INPUT_USERNAME" -e "INPUT_KEY" -e "INPUT_PORT" -e "INPUT_SCRIPT" -e "INPUT_PASSPHRASE" -e "INPUT_PASSWORD" -e "INPUT_SYNC" -e "INPUT_USE_INSECURE_CIPHER" -e "INPUT_CIPHER" -e "INPUT_TIMEOUT" -e "INPUT_COMMAND_TIMEOUT" -e "INPUT_KEY_PATH" -e "INPUT_FINGERPRINT" -e "INPUT_PROXY_HOST" -e "INPUT_PROXY_PORT" -e "INPUT_PROXY_USERNAME" -e "INPUT_PROXY_PASSWORD" -e "INPUT_PROXY_PASSPHRASE" -e "INPUT_PROXY_TIMEOUT" -e "INPUT_PROXY_KEY" -e "INPUT_PROXY_KEY_PATH" -e "INPUT_PROXY_FINGERPRINT" -e "INPUT_PROXY_CIPHER" -e "INPUT_PROXY_USE_INSECURE_CIPHER" -e "INPUT_SCRIPT_STOP" -e "INPUT_ENVS" -e "INPUT_ENVS_FORMAT" -e "INPUT_DEBUG" -e "INPUT_ALLENVS" -e "INPUT_REQUEST_PTY" -e "HOME" -e "GITHUB_JOB" -e "GITHUB_REF" -e "GITHUB_SHA" -e "GITHUB_REPOSITORY" -e "GITHUB_REPOSITORY_OWNER" -e "GITHUB_REPOSITORY_OWNER_ID" -e "GITHUB_RUN_ID" -e "GITHUB_RUN_NUMBER" -e "GITHUB_RETENTION_DAYS" -e "GITHUB_RUN_ATTEMPT" -e "GITHUB_ACTOR_ID" -e "GITHUB_ACTOR" -e "GITHUB_WORKFLOW" -e "GITHUB_HEAD_REF" -e "GITHUB_BASE_REF" -e "GITHUB_EVENT_NAME" -e "GITHUB_SERVER_URL" -e "GITHUB_API_URL" -e "GITHUB_GRAPHQL_URL" -e "GITHUB_REF_NAME" -e "GITHUB_REF_PROTECTED" -e "GITHUB_REF_TYPE" -e "GITHUB_WORKFLOW_REF" -e "GITHUB_WORKFLOW_SHA" -e "GITHUB_REPOSITORY_ID" -e "GITHUB_TRIGGERING_ACTOR" -e "GITHUB_WORKSPACE" -e "GITHUB_ACTION" -e "GITHUB_EVENT_PATH" -e "GITHUB_ACTION_REPOSITORY" -e "GITHUB_ACTION_REF" -e "GITHUB_PATH" -e "GITHUB_ENV" -e "GITHUB_STEP_SUMMARY" -e "GITHUB_STATE" -e "GITHUB_OUTPUT" -e "RUNNER_OS" -e "RUNNER_ARCH" -e "RUNNER_NAME" -e "RUNNER_ENVIRONMENT" -e "RUNNER_TOOL_CACHE" -e "RUNNER_TEMP" -e "RUNNER_WORKSPACE" -e "ACTIONS_RUNTIME_URL" -e "ACTIONS_RUNTIME_TOKEN" -e "ACTIONS_CACHE_URL" -e "ACTIONS_RESULTS_URL" -e GITHUB_ACTIONS=true -e CI=true -v "/var/run/docker.sock":"/var/run/docker.sock" -v "/home/runner/work/_temp/_github_home":"/github/home" -v "/home/runner/work/_temp/_github_workflow":"/github/workflow" -v "/home/runner/work/_temp/_runner_file_commands":"/github/file_commands" -v "/home/runner/work/klario-tech/klario-tech":"/github/workspace" 00ee1d:cf3f0ccdd8eb43b69ce2f4bcb281d133
======CMD======
set -e
# Prepare deploy dir
cd /tmp/klario-deploy

# Load image & copy files
docker load < klario-app.tar.gz
mkdir -p ~/klario && cp -r * ~/klario/
cd ~/klario
chmod +x scripts/*.sh

# Bring up services
docker-compose -f docker-compose.prod.yml pull
docker-compose -f docker-compose.prod.yml up -d

# 1) App container health
echo "== App Container Health =="
for i in {1..10}; do
  if docker-compose -f docker-compose.prod.yml exec -T klario-app curl -fsS http://localhost:5000/health; then
    echo "âœ… App container healthy"; break
  fi
  sleep 5
done

# 2) Proxy/SSL health
echo "== Proxy/SSL Health =="
for i in {1..10}; do
  if curl -fsS https://getklario.com/health; then
    echo "âœ… Proxy & SSL healthy"; break
  fi
  sleep 5
done

echo "ðŸš€ Deployment completed successfully!"

======END======
out: Loaded image: klario:latest
err: The POSTGRES_PASSWORD variable is not set. Defaulting to a blank string.
err: The REDIS_PASSWORD variable is not set. Defaulting to a blank string.
err: Couldn't find env file: /home/***/klario/.env
2025/08/05 06:27:49 Process exited with status 1
0s
0s
0s
0s
